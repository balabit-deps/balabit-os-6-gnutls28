From e1d6c59a7b0392fb3b8b75035614084a53e2c8c9 Mon Sep 17 00:00:00 2001
From: Nikos Mavrogiannopoulos <nmav@redhat.com>
Date: Wed, 24 May 2017 11:48:24 +0200
Subject: [PATCH] gnutls_ocsp_status_request_enable_client: documented requirements for parameters

That is, the fact that extensions and responder_id parameters must be
allocated, and are assigned to the session.

Signed-off-by: Nikos Mavrogiannopoulos <nmav@redhat.com>
---
 lib/ext/status_request.c | 12 +++++++++---
 1 file changed, 9 insertions(+), 3 deletions(-)

Index: gnutls28-3.4.10/lib/ext/status_request.c
===================================================================
--- gnutls28-3.4.10.orig/lib/ext/status_request.c	2017-06-12 09:32:31.988618904 -0400
+++ gnutls28-3.4.10/lib/ext/status_request.c	2017-06-12 09:32:31.984618855 -0400
@@ -265,9 +265,15 @@ _gnutls_status_request_recv_params(gnutl
  *
  * This function is to be used by clients to request OCSP response
  * from the server, using the "status_request" TLS extension.  Only
- * OCSP status type is supported. A typical server has a single
- * OCSP response cached, so @responder_id and @extensions
- * should be null.
+ * OCSP status type is supported.
+ *
+ * The @responder_id array, its containing elements as well as
+ * the data of @extensions, must be allocated using gnutls_malloc(). They
+ * will be deinitialized on session cleanup.
+ *
+ * Due to the difficult semantics of the @responder_id and @extensions
+ * parameters, it is recommended to only call this function with these
+ * parameters set to %NULL.
  *
  * Returns: On success, %GNUTLS_E_SUCCESS (0) is returned,
  *   otherwise a negative error code is returned.
