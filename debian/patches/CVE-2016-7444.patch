From c089e019ef83a77b2fdca24d0875ef25f6b38f1a Mon Sep 17 00:00:00 2001
From: Nikos Mavrogiannopoulos <nmav@gnutls.org>
Date: Sat, 27 Aug 2016 17:03:09 +0200
Subject: [PATCH] ocsp: corrected the comparison of the serial size in OCSP response

Previously the OCSP certificate check wouldn't verify the serial length
and could succeed in cases it shouldn't.

Reported by Stefan Buehler.
---
 lib/x509/ocsp.c | 1 +
 1 file changed, 1 insertion(+), 0 deletions(-)

Index: gnutls28-3.4.10/lib/x509/ocsp.c
===================================================================
--- gnutls28-3.4.10.orig/lib/x509/ocsp.c	2017-01-26 10:10:24.872428703 -0500
+++ gnutls28-3.4.10/lib/x509/ocsp.c	2017-01-26 10:10:24.868428646 -0500
@@ -1318,6 +1318,7 @@
 		gnutls_assert();
 		goto cleanup;
 	}
+	cserial.size = t;
 
 	if (rserial.size != cserial.size
 	    || memcmp(cserial.data, rserial.data, rserial.size) != 0) {
